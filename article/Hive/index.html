<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hive | lvqingzheng的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="回顾12 今天任务12345hive的产生hive的介绍hive的安装hive的数据类型基本命令操作 教学目标12345了解hive的产生背景理解并掌握hive的定义掌握hive的本地安装掌握hive的基本类型掌握hive的基本命令 一、hive产生背景Apache Hive数据仓库软件可以使用SQL方便地阅读、编写和管理分布在分布式存储中的大型数据集。结构可以投射到已经存储的数据上。提供了一个命">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive">
<meta property="og:url" content="https://lvqingzheng.github.io/article/Hive/index.html">
<meta property="og:site_name" content="lvqingzheng的博客">
<meta property="og:description" content="回顾12 今天任务12345hive的产生hive的介绍hive的安装hive的数据类型基本命令操作 教学目标12345了解hive的产生背景理解并掌握hive的定义掌握hive的本地安装掌握hive的基本类型掌握hive的基本命令 一、hive产生背景Apache Hive数据仓库软件可以使用SQL方便地阅读、编写和管理分布在分布式存储中的大型数据集。结构可以投射到已经存储的数据上。提供了一个命">
<meta property="og:locale" content="default">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/QQ%E5%9B%BE%E7%89%8720180402111948.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/1.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/2.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/3.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/4.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/5.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/6.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/7.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/8.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/8-1.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/12.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/13.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-1.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-2.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-3.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/15.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/16.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/6.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/17.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/18.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/20.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/19%E2%80%94%E2%80%941.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/22.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/23.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/24.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/25.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/26.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/27.png">
<meta property="og:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/37.png">
<meta property="og:updated_time" content="2018-10-15T04:29:50.360Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hive">
<meta name="twitter:description" content="回顾12 今天任务12345hive的产生hive的介绍hive的安装hive的数据类型基本命令操作 教学目标12345了解hive的产生背景理解并掌握hive的定义掌握hive的本地安装掌握hive的基本类型掌握hive的基本命令 一、hive产生背景Apache Hive数据仓库软件可以使用SQL方便地阅读、编写和管理分布在分布式存储中的大型数据集。结构可以投射到已经存储的数据上。提供了一个命">
<meta name="twitter:image" content="c:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/QQ%E5%9B%BE%E7%89%8720180402111948.png">
  
    <link rel="alternate" href="/atom.xml" title="lvqingzheng的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">lvqingzheng的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://lvqingzheng.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Hive" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/article/Hive/" class="article-date">
  <time datetime="2018-10-15T04:28:25.000Z" itemprop="datePublished">2018-10-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Hive
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="今天任务"><a href="#今天任务" class="headerlink" title="今天任务"></a>今天任务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive的产生</span><br><span class="line">hive的介绍</span><br><span class="line">hive的安装</span><br><span class="line">hive的数据类型</span><br><span class="line">基本命令操作</span><br></pre></td></tr></table></figure>
<h3 id="教学目标"><a href="#教学目标" class="headerlink" title="教学目标"></a>教学目标</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">了解hive的产生背景</span><br><span class="line">理解并掌握hive的定义</span><br><span class="line">掌握hive的本地安装</span><br><span class="line">掌握hive的基本类型</span><br><span class="line">掌握hive的基本命令</span><br></pre></td></tr></table></figure>
<h3 id="一、hive产生背景"><a href="#一、hive产生背景" class="headerlink" title="一、hive产生背景"></a>一、hive产生背景</h3><p>Apache Hive数据仓库软件可以使用SQL方便地阅读、编写和管理分布在分布式存储中的大型数据集。结构可以投射到已经存储的数据上。提供了一个命令行工具和JDBC驱动程序来将用户连接到Hive。</p>
<ul>
<li><p>由Facebook开源，最初用于解决海量结构化的日志数据统计问题</p>
</li>
<li><p>MapReduce编程的不便性</p>
</li>
<li>HDFS上的文件缺少Schema（字段名，字段类型等）</li>
</ul>
<h3 id="二、Hive是什么"><a href="#二、Hive是什么" class="headerlink" title="二、Hive是什么"></a>二、Hive是什么</h3><ul>
<li>构建在Hadoop之上的数据仓库</li>
<li>Hive定义了一种类SQL查询语言：HQL（类似SQL但不完全相同）</li>
<li>通常用于进行离线数据处理（采用MapReduce）</li>
<li>底层支持多种不同的执行引擎（Hive on MapReduce、Hive on Tez、Hive on Spark）</li>
<li>支持多种不同的压缩格式、存储格式以及自定义函数（压缩：GZIP、LZO、Snappy、BZIP2..  ； 存储：TextFile、SequenceFile、RCFile、ORC、Parquet ； UDF：自定义函数）</li>
</ul>
<p><strong>到底什么是Hive，我们先看看Hive官网Wiki是如何介绍Hive的(<a href="https://cwiki.apache.org/confluence/display/Hive/Home)：" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/Hive/Home)：</a></strong></p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/QQ%E5%9B%BE%E7%89%8720180402111948.png" alt="QQ图片20180402111948"></p>
<p><strong>Apache Hive</strong><br>Apache Hive™ 数据仓库软件为分布式存储的大数据集上的读、写、管理提供很大方便，同时还可以用SQL语法在大数据集上查询。</p>
<p>1、是一种易于对数据实现提取、转换、加载的工具(ETL)的工具。可以理解为数据清洗分析展现。<br>2、它有一种将大量格式化数据强加上结构的机制。<br>3、它可以分析处理直接存储在hdfs中的数据或者是别的数据存储系统中的数据，如hbase。<br>4、查询的执行经由mapreduce完成。<br>5、hive可以使用存储过程<br>6、通过Apache YARN和Apache Slider实现亚秒级的查询检索。</p>
<h3 id="三、hive的安装"><a href="#三、hive的安装" class="headerlink" title="三、hive的安装"></a>三、hive的安装</h3><h4 id="1-hive的单机安装（使用derby做元数据存储）"><a href="#1-hive的单机安装（使用derby做元数据存储）" class="headerlink" title="1.hive的单机安装（使用derby做元数据存储）"></a>1.hive的单机安装（使用derby做元数据存储）</h4><ul>
<li><p>安装包准备</p>
<p>将hive安装包 apache-hive-1.2.1-bin.tar.gz  上传到虚拟机/bigdata/下 </p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/1.png" alt="1"></p>
<p>JDK安装包 jdk-8u151-x64.gz</p>
<p>集群的准备（linux1,linux2,linux3）</p>
</li>
<li><p>hive的解压安装</p>
<p>将上传的hive解压缩至虚拟机/app目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf /app/apache-hive-1.2.1-bin.tar.gz -C /app</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/2.png" alt="2"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /app/apache-hive-1.2.1-bin/ /app/hive-1.2.1</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/3.png" alt="3"></p>
</li>
<li><p>配置hive的配置文件</p>
<p>查看配置文件内容</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/4.png" alt="4"></p>
<p>拷贝配置文件hive-env.sh.template为hive-env.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /app/hive-1.2.1/conf/hive-env.sh.template /app/hive-1.2.1/conf/hive-env.sh</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/5.png" alt="5"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /app/hive-1.2.1/conf/hive-env.sh</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/6.png" alt="6"></p>
</li>
<li><p>配置hive的环境变量</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>
<p>  <img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/7.png" alt="7"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br><span class="line">which hive</span><br></pre></td></tr></table></figure>
<p>  <img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/8.png" alt="8"></p>
<ul>
<li><p>启动hadoop集群</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/8-1.png" alt="8-1"></p>
</li>
<li><p>启动hive服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/12.png" alt="12"></p>
</li>
<li><p>查看数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/13.png" alt="13"></p>
</li>
<li><p>创建数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create database myhive;</span><br><span class="line">show databases;</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-1.png" alt="9-1"></p>
</li>
<li><p>创建表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table student（id int，chinese string，math string，English string）；</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-2.png" alt="9-2"></p>
</li>
<li><p>加载数据并查询</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">load data local inpath '/root/student.txt' into table student;</span><br><span class="line">select * from student;</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/9-3.png" alt="9-3"></p>
</li>
</ul>
<h4 id="2-hive的独立安装模式（使用mysql做元数据存储）"><a href="#2-hive的独立安装模式（使用mysql做元数据存储）" class="headerlink" title="2.hive的独立安装模式（使用mysql做元数据存储）"></a>2.hive的独立安装模式（使用mysql做元数据存储）</h4><ul>
<li>安装MySQL服务器端和MySQL客户端，并启动mysql服务。</li>
<li>在linux1上为Hive建立相应的MySQL账户，并赋予足够的权限</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create user &apos;hive&apos; identified by &apos;123456&apos;;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO hive@&apos;%&apos; IDENTIFIED BY &apos;123456&apos; with grant option;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO hive@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos; with grant option;</span><br><span class="line">flush privileges</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/15.png" alt="15"></p>
<p>查看是否成功</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/16.png" alt="16"></p>
<ul>
<li><p>在内嵌模式下继续配置hive：hive-site.xml,hive-env.sh</p>
<p>配置hive-env.sh</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/6.png" alt="6"></p>
<p>配置hive-site.xml,拷贝/app/hive-1.2.1/conf下的hive-default.xml文件为hive-site.xml</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/17.png" alt="17"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /app/hive-1.2.1/conf/hive-default.xml.template /app/hive-1.2.1/conf/hive-site.xml</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/18.png" alt="18"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /app/hive-1.2.1/conf/hive-site.xml</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/20.png" alt="20"></p>
</li>
<li><p>拷贝数据驱动jar包到指定目录/app/hive-1.2.1/lib/下。没有驱动包会报错</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/19%E2%80%94%E2%80%941.png" alt=" 19"></p>
</li>
<li><p>使用命令行的方式启动hive服务，然后查看数据库，创建数据库名为heihei,查看集群web页面</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/22.png" alt="22"></p>
<p>查看集群web页面，可以看见在hdfs上生成了对应heihei数据库的文件目录</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/23.png" alt="23"></p>
</li>
<li><p>使用beeline访问hive</p>
<p>exit命令退出刚才的hive服务，在linux1上修改hadoop 配置文件 etc/hadoop/core-site.xml,加入如下配置项，<br>通过httpfs接口匿名的方式登录到hdfs文件系统。然后重新启动集群。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.root.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用命令hive –service hiveserver2 &amp; 后台启动hive服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive --service hiveserver2 &amp;</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/24.png" alt="24"></p>
<p>克隆窗口作为客户端连接，执行beeline脚本</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/25.png" alt="25"></p>
<p>连接服务端，这种方式使用了thrift服务，10000为默认的连接端口号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!connect jdbc:hive2://linux1:10000</span><br></pre></td></tr></table></figure>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/26.png" alt="26"></p>
<p>验证连接的是不是我们刚才用命令行方式访问的hive服务</p>
<p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/27.png" alt="27"></p>
</li>
</ul>
<h4 id="3-hive的远程安装模式"><a href="#3-hive的远程安装模式" class="headerlink" title="3.hive的远程安装模式"></a>3.hive的远程安装模式</h4><p><strong>安装规划：</strong></p>
<pre><code>集群linux1，linux2,linux3;使用linux1作为hive服务端，linux2作为客户端连接，linux3提供mysql数据库存储元数据。
</code></pre><p><strong>安装准备：</strong></p>
<ul>
<li>linux1，linux2安装hive，linux3上安装mysql数据库。</li>
<li>linux1,linux2,linux3三台机器搭建hadoop集群。</li>
<li>jdk版本1.7及以上。</li>
</ul>
<p><strong>安装步骤：</strong></p>
<p>1.在linux3上安装mysql数据库，可以使用yum安装或者上传安装包使用rpm命令安装</p>
<p>在安装好的数据上进行以下操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create user &apos;hive&apos; identified by &apos;123456&apos;;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO hive@&apos;%&apos; IDENTIFIED BY &apos;123456&apos; with grant option;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO hive@&apos;localhost&apos; IDENTIFIED BY &apos;123456&apos; with grant option;</span><br><span class="line">flush privileges</span><br></pre></td></tr></table></figure>
<p>2、选节点linux1作为hive的服务端，hive-env.sh配置与前两种安装方式一样。以下为hive-site.xml的配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /app/hive-1.2.1/conf/hive/hive-site.xml</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/multiuserhive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://linux3:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意：<br>作为服务端需要连接mysql，所以需要将mysql的驱动包拷贝到hive的lib目录下：</p>
<p>3、选择服务器linux2作为hive客户端，并将配置好的服务端的hive目录拷贝到该节点上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /app/hive-1.2.1/conf/hive/hive-site.xml</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/multiuserhive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--配置是否在本地开启memstore服务--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.local<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--配置元数据服务的url--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://linux1:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  <span class="comment">&lt;!--linux1是hive服务器的ip--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4、启动多用户的hive：</p>
<ul>
<li><p>hive –service metastore  (该启动非后台启动,退出后客户端就连接不上)</p>
<p>后台启动metastore: hive –service metastore &amp;</p>
</li>
<li><p>在客户端linux2上连接hive服务：hive </p>
</li>
</ul>
<p>四、hive的列的分割符 </p>
<h3 id="四、hive的数据类型"><a href="#四、hive的数据类型" class="headerlink" title="四、hive的数据类型"></a>四、hive的数据类型</h3><h4 id="1-基本数据类型"><a href="#1-基本数据类型" class="headerlink" title="1.基本数据类型"></a>1.基本数据类型</h4><table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>1字节 有符号整数</td>
<td>1</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2字节 有符号整数</td>
<td>1</td>
</tr>
<tr>
<td>INT</td>
<td>4字节 有符号整数</td>
<td>1</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8字节 有符号整数</td>
<td>1</td>
</tr>
<tr>
<td>FLOAT</td>
<td>4字节 单精度浮点数</td>
<td>1.0</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8字节 双精度浮点数</td>
<td>1.0</td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>true/false</td>
<td>TRUE</td>
</tr>
<tr>
<td>STRING</td>
<td>字符串</td>
<td>‘a’,”a”</td>
</tr>
<tr>
<td>BINARY</td>
<td>字节数组</td>
<td></td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>精度到纳秒的时间戳</td>
<td>132550245000，‘2016-01-01 03:04:05.123456789’</td>
</tr>
</tbody>
</table>
<p><strong>新增数据类型TIMESTAMP的值可以是</strong>：</p>
<ul>
<li>整数：距离Unix新纪元时间（1970年1月1日，午夜12点）的秒数</li>
<li>浮点数：距离Unix新纪元时间的秒数，精确到纳秒（小数点后保留9位数）</li>
<li>字符串：JDBC所约定的时间字符串格式，格式为：YYYY-MM-DD hh:mm:ss:fffffffff</li>
</ul>
<p><strong>BINARY数据类型用于存储变长的二进制数据。</strong></p>
<h4 id="2-复杂数据类型"><a href="#2-复杂数据类型" class="headerlink" title="2.复杂数据类型"></a>2.复杂数据类型</h4><table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARRAY</td>
<td>一组有序字段，字段的类型必须相同</td>
<td>array(1,2)</td>
</tr>
<tr>
<td>MAP</td>
<td>一组无需的键值对，键的类型必须是原子的，值可以是任何类型。同一个映射的键的类型必须相同，值的类型也必须相同。</td>
<td>map(‘a’,1,’b’,2)</td>
</tr>
<tr>
<td>STRUCT</td>
<td>一组命名的字段，字段的类型可以不同</td>
<td>struct(‘a’,1,1,0)</td>
</tr>
</tbody>
</table>
<h4 id="3-数据类型应用举例"><a href="#3-数据类型应用举例" class="headerlink" title="3.数据类型应用举例"></a>3.数据类型应用举例</h4><p><img src="C:/Users/dell/Desktop/BigData/hadoop/Hive%E8%AF%BE%E4%BB%B6/%E7%AC%AC40%E5%A4%A9-hive%E7%9A%84%E7%AE%80%E4%BB%8B%E4%B8%8E%E5%AE%89%E8%A3%85%EF%BC%8Chive%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/37.png" alt="37"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建员工表，使用默认分割符</span></span></span><br><span class="line">CREATE TABLE employee(</span><br><span class="line">      name STRING,</span><br><span class="line">      salary FLOAT,</span><br><span class="line">      leader ARRAY&lt;STRING&gt;,</span><br><span class="line">      deductions MAP&lt;STRING,FLOAT&gt;,</span><br><span class="line">      address STRUCT&lt;street:STRING,city:STRING,state:STRING,zip:INT&gt;</span><br><span class="line">      )</span><br><span class="line">      ;</span><br></pre></td></tr></table></figure>
<h4 id="4-列的分割符"><a href="#4-列的分割符" class="headerlink" title="4.列的分割符"></a>4.列的分割符</h4><p> HiveQL文本文件数据编码表</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>\n</td>
<td>对于文本文件来说，每行都是一条记录，因此换行符可以分割记录</td>
</tr>
<tr>
<td>^A(Ctrl+A)</td>
<td>用于分隔字段（列）。在CREATE TABLE语句中可以使用八进制编码\001表示</td>
</tr>
<tr>
<td>^B</td>
<td>用于分隔ARRARY或者STRUCT中的元素，或用于MAP中键-值对之间的分隔。在CREATE TABLE语句中可以使用八进制编码\002表示</td>
</tr>
<tr>
<td>^C</td>
<td>用于MAP中键和值之间的分隔。在CREATE TABLE语句中可以使用八进制编码\003表示</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE employee(</span><br><span class="line">  name                    STRING,</span><br><span class="line">  salary                   FLOAT,</span><br><span class="line">  subordinates         ARRAY&lt;STRING&gt;,</span><br><span class="line">  deductions            MAP&lt;STRING,FLOAT&gt;,</span><br><span class="line">  address                  STRUCT&lt;street:STRING,city:STRING,state:STRING,zip:INT&gt;</span><br><span class="line">  )</span><br><span class="line">ROW FORMAT DELIMITED  </span><br><span class="line">FIELDS TERMINATED BY &apos;\001&apos;  </span><br><span class="line">COLLECTION ITEMS TERMINATED BY &apos;\002&apos;  </span><br><span class="line">MAP KEYS TERMINATED BY &apos;\003&apos;  </span><br><span class="line">LINES TERMINATED BY &apos;\n&apos;  </span><br><span class="line">STORED AS TEXTFILE;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>[ROW FORMAT DELIMITED]</strong>关键字，是用来设置创建的表在加载数据的时候，支持的列分隔符；</li>
<li><strong>FIELDS TERMINATED BY ‘\001’</strong> ，字符\001是^A的八进制数。这个子句表明Hive将使用^A字符作为列分隔符。</li>
</ul>
<ul>
<li><strong>COLLECTION ITEMS TERMINATED BY ‘\002’</strong>  ，字符\002是^B的八进制数。这个子句表明Hive将使用^B字符作为集合元素的分隔符。</li>
</ul>
<ul>
<li><strong>MAP KEYS TERMINATED BY ‘\003’</strong>  ，字符\003是^C的八进制数。这个子句表明Hive将使用^C字符作为map的键和值之间的分隔符。</li>
<li><strong>LINES TERMINATED BY ‘\n’ 、STORED AS TEXTFILE</strong>这个两个子句不需要ROW FORMAT DELIMITED 关键字</li>
<li>Hive目前对于LINES TERMINATED BY…仅支持字符‘\n’，行与行之间的分隔符只能为‘\n’。</li>
</ul>
<h3 id="五、hive的基本命令"><a href="#五、hive的基本命令" class="headerlink" title="五、hive的基本命令"></a>五、hive的基本命令</h3><h4 id="1-数据库的创建："><a href="#1-数据库的创建：" class="headerlink" title="1.数据库的创建："></a>1.数据库的创建：</h4><pre><code>本质上是在hdfs上创建一个目录，使用comment加入数据库的描述信息，描述信息放在引号里。数据库的属性信息放在描述信息之后用with dbproperties 加入，属性信息放在括号内，属性名和属性值放在引号里，用等号连接有多条属性用逗号分隔
</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建一个数据库名为myhive,加入描述信息及属性信息</span></span></span><br><span class="line">create database myhive comment 'this is myhive db'</span><br><span class="line">with dbproperties ('author'='me','date'='2018-4-21')</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查看属性信息</span></span></span><br><span class="line">describe database extended myhive;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#在原有数据库基础上加入新的属性信息</span></span></span><br><span class="line">alter database myhive set dbproperties ('id'='1');</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#切换库</span></span></span><br><span class="line">use myhive;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#删除数据库</span></span></span><br><span class="line">drop database myhive;</span><br></pre></td></tr></table></figure>
<h4 id="2-表的创建"><a href="#2-表的创建" class="headerlink" title="2.表的创建"></a>2.表的创建</h4><pre><code>默认创建到当前数据库(default是hive默认库)，创建表的本质也是在hdfs上创建一个目录
</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">==================练习array的使用，本地数据加载，对比hive与mysql的区别========================</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建数据array.txt映射表t_array</span></span></span><br><span class="line">create table if not exists t_array(</span><br><span class="line">id int comment 'this is id',</span><br><span class="line">score array&lt;tinyint&gt;</span><br><span class="line">)</span><br><span class="line">comment 'this is my table'</span><br><span class="line">row format delimited fields terminated by ','</span><br><span class="line">collection items terminated by '|'</span><br><span class="line">tblproperties ('id'='11','author'='me')</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#从本地加载数据array.txt文件</span></span></span><br><span class="line">load data local inpath '/testdata/array.txt' into table t_array;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询表里面的数据</span></span></span><br><span class="line">select * from t_array;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询id=1的第一条成绩信息</span></span></span><br><span class="line">select score[0] from t_array where id=1;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询id=2的成绩条数</span></span></span><br><span class="line">select size(score) from t_array where id=2;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询一共有多少条数据</span></span></span><br><span class="line">select count(*) from t_array;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#把arra1.txt追加的方式从本地加载进这个表中</span></span></span><br><span class="line">load data local inpath '/testdata/array1.txt' into table t_array;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#把test.txt追加的方式从本地加载进这个表中</span></span></span><br><span class="line">load data local inpath '/testdata/test.txt' into table t_array;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#从本地覆盖方式加载数据array.txt文件至t_array表中</span></span></span><br><span class="line">load data local inpath '/testdata/array.txt' overwrite into table t_array;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">====================练习map的使用，查看表的创建过程，创建表的同时指定数据位置===================</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建数据map.txt的映射表t_map</span></span></span><br><span class="line">create table if not exists t_map(</span><br><span class="line">id int,</span><br><span class="line">score map&lt;string,int&gt;</span><br><span class="line">)</span><br><span class="line">row format delimited fields terminated by ','</span><br><span class="line">collection items terminated by '|'</span><br><span class="line">map keys terminated by ':'</span><br><span class="line">stored as textfile</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#从hdfs加载数据，map.txt在hdfs上的位置位置被移动。</span></span></span><br><span class="line">load data local inpath '/testdata/map.txt' into table t_map;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询id=1的数学成绩</span></span></span><br><span class="line">select score['math'] from t_map where id=1;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查询每个人考了多少科</span></span></span><br><span class="line">select size(score) from t_map;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查看表的创建过程</span></span></span><br><span class="line">show create table t_map;</span><br><span class="line">CREATE TABLE `t_map1`(</span><br><span class="line">  `id` int, </span><br><span class="line">  `score` map&lt;string,int&gt;)</span><br><span class="line">ROW FORMAT DELIMITED </span><br><span class="line">  FIELDS TERMINATED BY ',' </span><br><span class="line">  COLLECTION ITEMS TERMINATED BY '|' </span><br><span class="line">  MAP KEYS TERMINATED BY ':' </span><br><span class="line">STORED AS INPUTFORMAT </span><br><span class="line">  'org.apache.hadoop.mapred.TextInputFormat' </span><br><span class="line">OUTPUTFORMAT </span><br><span class="line">  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'</span><br><span class="line">LOCATION</span><br><span class="line">  'hdfs://linux5:8020/user/hive/warehouse/t_map'</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建表的同时指定数据的位置</span></span></span><br><span class="line">create table if not exists t_map2(</span><br><span class="line">id int,</span><br><span class="line">score map&lt;string,int&gt;</span><br><span class="line">)</span><br><span class="line">row format delimited fields terminated by ','</span><br><span class="line">collection items terminated by '|'</span><br><span class="line">map keys terminated by ':'</span><br><span class="line">stored as textfile</span><br><span class="line">location '/test'</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#删除表</span></span></span><br><span class="line">drop table test2;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">====================练习struct的使用，外部表的创建，总结内部表外部表的区别=====================</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建数据struct.txt的映射表t_struct(使用external关键字并指定数据位置创建外部表)</span></span></span><br><span class="line">create external table if not exists t_struct(</span><br><span class="line">id int,</span><br><span class="line">grade struct&lt;score:int,desc:string,point:string&gt;</span><br><span class="line">)</span><br><span class="line">row format delimited fields terminated by ','</span><br><span class="line">collection items terminated by '|'</span><br><span class="line">location '/external'</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#查看score&gt;90的信息</span></span></span><br><span class="line">select * from t_struct where grade.score&gt;90;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建外部表t_struct1</span></span></span><br><span class="line">create external table if not exists t_struct1(</span><br><span class="line">id int,</span><br><span class="line">grade struct&lt;score:int,desc:string,point:string&gt;</span><br><span class="line">)</span><br><span class="line">row format delimited fields terminated by ','</span><br><span class="line">collection items terminated by '|'</span><br><span class="line">;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#insert into 方式追加数据</span></span></span><br><span class="line">insert into table t_struct1 select * from t_struct;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#删除表：只有元数据被删除，数据文件仍然存储在hdfs上</span></span></span><br><span class="line">drop table t_struct;</span><br></pre></td></tr></table></figure>
<h4 id="3-为hive表加载数据："><a href="#3-为hive表加载数据：" class="headerlink" title="3.为hive表加载数据："></a>3.为hive表加载数据：</h4><pre><code>将数据文件copy到对应的表目录下面(如果是hdfs上的目录，将是剪切)。
</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#load方式从本地加载数据，会将数据拷贝到表所对应的hdfs目录</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">追加</span></span><br><span class="line">load data local inpath '本地数据路径' into table tablename</span><br><span class="line"><span class="meta">#</span><span class="bash">覆盖</span></span><br><span class="line">load data local inpath '本地数据路径' overwrite into table tablename</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#load方式从hdfs加载数据,会将数据移动到对应的hdfs目录</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">追加</span></span><br><span class="line">load data inpath 'hdfs数据路径' into table tablename</span><br><span class="line"><span class="meta">#</span><span class="bash">覆盖</span></span><br><span class="line">load data inpath 'hdfs数据路径' into table tablename</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#通过查询语句向表中插入数据</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">追加</span></span><br><span class="line">insert into table table1 select * from table2</span><br><span class="line"><span class="meta">#</span><span class="bash">覆盖</span></span><br><span class="line">insert overwrite into table table1 select * from table2</span><br></pre></td></tr></table></figure>
<h4 id="4-内部表与外部表"><a href="#4-内部表与外部表" class="headerlink" title="4.内部表与外部表"></a>4.内部表与外部表</h4><p><strong>内部表：</strong>在Hive 中创建表时，默认情况下Hive 负责管理数据。即，Hive 把数据移入它的”仓库目录” (warehouse directory)</p>
<p><strong>外部表：</strong>由用户来控制数据的创建和删除。外部数据的位置需要在创建表的时候指明。使用<strong>EXTERNAL</strong> 关键字以后， Hìve 知道数据并不由自己管理，因此不会把数据移到自己的仓库目录。事实上，在定义时，它甚至不会检查这一外部位置是否存在。这是一个非常重要的特性，因为这意味着你可以把创建数据推迟到创建表之后才进行。</p>
<p><strong>区别：</strong>丢弃内部表时，这个表(包括它的元数据和数据)会被一起删除。丢弃外部表时，Hive 不会碰数据，只会删除元数据，而不会删除数据文件本身</p>
<h4 id="5-表属性修改"><a href="#5-表属性修改" class="headerlink" title="5.表属性修改"></a>5.表属性修改</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#创建表log2</span></span></span><br><span class="line">CREATE external TABLE log2(</span><br><span class="line">id             string COMMENT 'this is id column',</span><br><span class="line">phonenumber     bigint,</span><br><span class="line">mac             string,</span><br><span class="line">ip               string,</span><br><span class="line">url              string,</span><br><span class="line">status1             string,</span><br><span class="line">status2          string,</span><br><span class="line">up           int,</span><br><span class="line">down           int,</span><br><span class="line">code            int,</span><br><span class="line">dt         String</span><br><span class="line">)</span><br><span class="line">COMMENT 'this is log table'  ##加入描述信息</span><br><span class="line">ROW FORMAT DELIMITED FIELDS TERMINATED BY ' '</span><br><span class="line">LINES TERMINATED BY '\n'</span><br><span class="line">stored as textfile;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#加载数据</span></span></span><br><span class="line">load local data inpath '/home/data.log.txt' into table log2;</span><br></pre></td></tr></table></figure>
<p><strong>修改表名</strong>：rename to</p>
<p>alter table原名rename to 新名</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table log rename to log2;</span><br></pre></td></tr></table></figure>
<p><strong>修改列名</strong>：change column</p>
<p>alter table 表名 change column 字段名 新字段名 字段类型【描述信息】;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#修改列名</span></span></span><br><span class="line">alter table log4 change column ip myip String;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#修改列名同时加入列的描述</span></span></span><br><span class="line">alter table log4 change column myip ip String comment 'this is mysip' ;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#使用after关键字，将修改后的字段放在某个字段后</span></span></span><br><span class="line">alter table log4 change column myip ip String comment 'this is myip' after code;</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#使用first关键字。将修改的字段调整到第一个字段</span></span></span><br><span class="line">alter table log4 change column ip myip int comment 'this is myip' first;</span><br></pre></td></tr></table></figure>
<p><strong>添加列</strong>：add columns</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#添加列，使用add columns,后面跟括号，括号里面加要加入的字段及字段描述，多个字段用逗号分开</span></span></span><br><span class="line">alter table log4 add columns(</span><br><span class="line">x int comment 'this x',</span><br><span class="line">y int</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><strong>删除列</strong>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#删除列，使用replace columns,后面跟括号，括号里面加要删除的字段，多个字段用逗号分开</span></span></span><br><span class="line">alter table log4 replace columns(x int,y int);</span><br><span class="line">alter table log4 replace columns(</span><br><span class="line">myip int,</span><br><span class="line">id string, </span><br><span class="line">phonenumber bigint,</span><br><span class="line">mac string,</span><br><span class="line">url string,</span><br><span class="line">status1 string,</span><br><span class="line">status2 string,</span><br><span class="line">up int,</span><br><span class="line">down int,  </span><br><span class="line">code int,</span><br><span class="line">dt string</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><strong>将内部表转换为外部表</strong>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">alter table log4 set tblproperties(</span><br><span class="line">'EXTERNAL' = 'TRUE'</span><br><span class="line">);</span><br><span class="line">alter table log4 set tblproperties(</span><br><span class="line">'EXTERNAL' = 'false'</span><br><span class="line">);</span><br><span class="line">alter table log4 set tblproperties(</span><br><span class="line">'EXTERNAL' = 'FALSE'</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lvqingzheng.github.io/article/Hive/" data-id="cjn9t2pbd000298veys59q6mk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/article/我的第一篇博客/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">我的第一篇博客</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/article/Hive/">Hive</a>
          </li>
        
          <li>
            <a href="/article/我的第一篇博客/">我的第一篇博客</a>
          </li>
        
          <li>
            <a href="/article/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 lvqingzheng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>